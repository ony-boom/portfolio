---
import Techno from "../components/Techno.astro";

interface Props {
  title: string;
  where: {
    name: string;
    url?: string;
  };
  when: [Date, Date?];
  locale?: string;
  techno?: string[];
}

const { title, where, techno, when, locale } = Astro.props;
const whenWithDefault = (when.length === 1 ? [...when, new Date()] : when) as [
  Date,
  Date,
];

const formattedDates = whenWithDefault.map((date) =>
  new Date(date).toLocaleDateString(locale ?? "en-US", {
    month: "long",
    year: "numeric",
  }),
);
---

<li>
  <h3 class="text-lg font-semibold">{title}</h3>

  <p class="flex items-center justify-between text-neutral-600">
    {
      where.url ? (
        <a href={where.url} target="_blank">
          {where.name}
        </a>
      ) : (
        <span>{where.name}</span>
      )
    }
    <span>
      <time class="capitalize" datetime={whenWithDefault[0].toISOString()}
        >{formattedDates[0]}</time
      > -{" "}
      <time
        class="capitalize"
        datetime={(whenWithDefault[1] ?? new Date()).toISOString()}
        >{formattedDates[1]}</time
      >
    </span>
  </p>

  <div class="mt-2">
    <slot name="description" />
  </div>

  <slot name="extra" />

  <div class="mt-2">
    {techno && <Techno techno={techno} />}
  </div>
</li>
